# DJI Edge SDK 项目日志轮转配置
# 作者: Celestial
# 创建时间: 2025-01-22
# 描述: 管理项目所有日志文件的轮转和清理

# C++ 组件日志 (dock_info_manager) - 特定日志文件
/home/celestial/dev/esdk-test/Edge-SDK/celestial_works/logs/dock_init_info.txt
/home/celestial/dev/esdk-test/Edge-SDK/celestial_works/logs/media_list.log
/home/celestial/dev/esdk-test/Edge-SDK/celestial_works/logs/media_monitor.log {
    daily
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 644 celestial celestial
    su celestial celestial
    postrotate
        # 如果dock_info_manager服务正在运行，发送信号重新打开日志文件
        if systemctl is-active --quiet dock-info-manager; then
            systemctl reload dock-info-manager || true
        fi
    endscript
}

# Python 组件日志 (media_sync)
/home/celestial/dev/esdk-test/Edge-SDK/celestial_nasops/logs/*.log {
    daily
    rotate 14
    compress
    delaycompress
    missingok
    notifempty
    create 644 celestial celestial
    su celestial celestial
    copytruncate
}

# 数据库操作日志
/home/celestial/dev/esdk-test/Edge-SDK/celestial_works/logs/database_*.log {
    weekly
    rotate 4
    compress
    delaycompress
    missingok
    notifempty
    create 644 celestial celestial
    su celestial celestial
}

# 测试报告日志
/home/celestial/dev/esdk-test/Edge-SDK/celestial_works/logs/test_report_*.txt {
    weekly
    rotate 8
    compress
    delaycompress
    missingok
    notifempty
    create 644 celestial celestial
    su celestial celestial
}